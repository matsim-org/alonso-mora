name: Unit and integration tests

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v2
      - name: Set up JDK 11
        uses: actions/setup-java@v1
        with:
          java-version: 11
      - name: Install GLPK and CBC
        run: sudo apt install glpk-utils coinor-cbc libglpk-java
      - name: Verify and install core
        working-directory: core
        run: mvn install --fail-at-end --batch-mode -Dmatsim.preferLocalDtds=true
      - name: Verify and install glpk
        working-directory: glpk
        run: mvn verify --fail-at-end --batch-mode -Dmatsim.preferLocalDtds=true -DargLine="-Djava.library.path=/usr/lib/x86_64-linux-gnu/jni"
